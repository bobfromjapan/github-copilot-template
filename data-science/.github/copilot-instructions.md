## 前提条件

- **回答は必ず日本語でしてください。**
- コードの変更をする際、変更量が200行を超える可能性が高い場合は、事前に「この指示では変更量が200行を超える可能性がありますが、実行しますか?」とユーザーに確認をとるようにしてください。
- 何か大きい変更を加える場合、まず何をするのか計画を立てた上で、ユーザーに「このような計画で進めようと思います。」と提案してください。
- **実行環境の制約:** 長時間の処理が必要となることから、エージェント側で`python`コマンドの実行は行わないでください。実行はユーザー側が行うため、エージェントはローカルにテキストやJSON形式で必要な出力を行うロギングの仕組みを必ず実装してください。

## 参照スキルガイド (Skills)

特定のタスクを実行する際は、必ず以下の対応するドキュメントを参照し、その指針に従ってください。

- **実験計画・アイデア管理 (Planning)**
  - 実装アイデアの生成、優先順位付け、`change_logs.md`の振り返り
  - 📄 `.github/skills/planning/SKILL.md`

- **データ探索・交差検証戦略 (EDA & Validation)**
  - `eda/`内のデータ分析の実行と記録、外挿性の高い予測モデルを構築するためのCV設計
  - 📄 `.github/skills/eda-validation/SKILL.md`

- **学習評価・ログ解析 (Evaluation)**
  - `logs/`や`reports/`の解析、Overfittingの検知、モデルの弱点分析
  - 📄 `.github/skills/evaluation/SKILL.md`

- **外部知識の収集・要約 (Research)**
  - KaggleのDiscussionや論文の要約、`scraps/`の管理
  - 📄 `.github/skills/research/SKILL.md`

## コーディング・実装ルール

- **フレームワーク:** Deep Learningモデルを構築する際は、PyTorch Lightningを利用すること。
- **再現性の確保:** 実験結果を正確に比較するため、PyTorch Lightningの`seed_everything`などを利用し、乱数シードを必ず固定してください。
- **ハードウェアの活用:** 学習・推論時は、利用可能なGPUを最大限活用するようにPyTorch LightningのTrainer（例: `accelerator='gpu'`）を設定してください。
- **バージョニング:** 新しいバージョンのコードを作成するときは、更新元となるバージョンのディレクトリ（`versionN/`）をコピーしてから変更を加えてください。
- **ロギング:** `train.py`のログにはlossと評価指標の推移、処理時間を含めてください。エージェントがパースしやすいように`metrics.json`を`logs/`に出力してください。

projectのフォルダ構成
```
project/
├── pyproject.toml # Pythonの依存関係を管理するファイル。uvの利用を想定。
├── README.md # プロジェクトの概要や、コードの実行方法などを記載するファイル。
├── .gitignore
├── change_logs.md # 各バージョンのmemo.mdに記載された内容、スコアの改善・悪化をまとめるファイル。バージョンごとに、実装の方針や工夫した点、その結果を簡潔にまとめる。
├── ideas.md # 実装のアイデアや、試してみたいことを記録するファイル。 
├── scraps/ # KaggleのNotebookやDiscussion、論文やブログなど、実装の参考となる情報を保存するフォルダ。
│   ├── **/*.ipynb
│   ├── **/*.md
│   ├── **/*.pdf
│   └── summary.md # scrapsフォルダの内容を要約するファイル。新しい情報をscrapsフォルダに追加したときは、必ずこのファイルも更新すること。
└─── exps/
    ├── data/    # データセットを格納するフォルダ。【実行するタスクに応じて異なった構造を持つため、書き換える】
    |   ├── train/
    |   └── test/
    ├── eda/ # EDAやデータの分析を行い、その結果を記録するコードやファイルを格納するフォルダ。
    │   ├── eda.py # EDAのコードを格納するファイル。EDAの内容は、データの分布や、特徴量の相関など、実装に役立つ情報を含むようにしてください。グラフの出力も必要に応じて行うようにしてください。
    │   └── data_facts.txt # AgentがEDAの内容を理解しやすいように、EDAの内容をテキスト形式で簡潔にまとめる。
    └── versionN/ # 実際にデータを処理するコードを格納するフォルダ。Nはバージョン番号。
        ├── logs/ # train.pyやtest.pyのログを格納するフォルダ。
        ├── models/ # 学習したモデルを格納するフォルダ。git管理の対象外とすること。
        ├── processed_data/ # 前処理したデータを格納するフォルダ。 git管理の対象外とすること。
        ├── results/ # 評価結果を格納するフォルダ。 
        │   ├── blobs/ # 評価結果のデータを格納するフォルダ。git管理の対象外とすること。
        │   └── reports/ # 評価結果のレポート、training時のloss curveや、test・Validationデータの推論結果を格納するフォルダ。
        ├── memo.md # そのバージョンでの実装の方針や、工夫した点などを記録するファイル。
        ├── train.py
        ├── test.py
        ├── reflect.py # このバージョンの結果をもとに、logs/内のテキストログやmetrics.json、reports/内の推論結果を読み込み、Overfittingの兆候や、現在のモデルが苦手としているデータクラス・傾向を分析するためのコードを必要に応じて実装する。
        ├── model.py # モデルの定義を行うコードを格納するファイル。
        ├── preprocess.py # データの前処理を行うコードを格納するファイル。
        ├── eval.py # 評価指標の計算を行うコードを格納するファイル。
        └── utils.py # ロギングの仕組みなど、コード全体で共通して利用する関数を格納するファイル。
```
